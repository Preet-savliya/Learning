Program.cs and Startup.cs file configuration

1. Minimal Hosting - Program.cs only
code:-

using Microsoft.AspNetCore.Builder;
using Microsoft.Extensions.DependencyInjection;
using Microsoft.Extensions.Hosting;
using Microsoft.EntityFrameworkCore;
using MyApp.Data;
using MyApp.Services;

var builder = WebApplication.CreateBuilder(args);

// --------------------------
// 1. Configure Services (DI)
// --------------------------
builder.Services.AddControllers();               // Add controllers
builder.Services.AddEndpointsApiExplorer();     // Swagger
builder.Services.AddSwaggerGen();               // Swagger UI

// Example: Adding EF Core DbContext
builder.Services.AddDbContext<AppDbContext>(options =>
    options.UseSqlServer(builder.Configuration.GetConnectionString("DefaultConnection")));

// Example: Adding custom services
builder.Services.AddScoped<IProductService, ProductService>();

// --------------------------
// 2. Build the app
// --------------------------
var app = builder.Build();

// --------------------------
// 3. Configure Middleware
// --------------------------
if (app.Environment.IsDevelopment())
{
    app.UseDeveloperExceptionPage();
    app.UseSwagger();
    app.UseSwaggerUI();
}

app.UseHttpsRedirection();

app.UseRouting();

app.UseAuthorization();   // Add authentication/authorization middleware here if needed

// Map controllers
app.MapControllers();

// Run the application
app.Run();








2. Optional Startup.cs Approach 
If you prefer to separate services and middleware, you can create a Startup.cs file like this:

Program.cs 

using Microsoft.AspNetCore.Builder;
using Microsoft.Extensions.Hosting;

var builder = WebApplication.CreateBuilder(args);

// Use Startup class to configure services
var startup = new MyApp.Startup(builder.Configuration);
startup.ConfigureServices(builder.Services);

var app = builder.Build();

// Use Startup class to configure middleware
startup.Configure(app, app.Environment);

app.Run();


Startup.cs 

using Microsoft.AspNetCore.Builder;
using Microsoft.AspNetCore.Hosting;
using Microsoft.Extensions.Configuration;
using Microsoft.Extensions.DependencyInjection;
using Microsoft.Extensions.Hosting;
using Microsoft.EntityFrameworkCore;
using MyApp.Data;
using MyApp.Services;

namespace MyApp
{
    public class Startup
    {
        public IConfiguration Configuration { get; }

        public Startup(IConfiguration configuration)
        {
            Configuration = configuration;
        }

        // --------------------------
        // Configure Services (DI)
        // --------------------------
        public void ConfigureServices(IServiceCollection services)
        {
            services.AddControllers();
            services.AddEndpointsApiExplorer();
            services.AddSwaggerGen();

            // Example: EF Core DbContext
            services.AddDbContext<AppDbContext>(options =>
                options.UseSqlServer(Configuration.GetConnectionString("DefaultConnection")));

            // Example: Custom service
            services.AddScoped<IProductService, ProductService>();
        }

        // --------------------------
        // Configure Middleware
        // --------------------------
        public void Configure(IApplicationBuilder app, IWebHostEnvironment env)
        {
            if (env.IsDevelopment())
            {
                app.UseDeveloperExceptionPage();
                app.UseSwagger();
                app.UseSwaggerUI();
            }

            app.UseHttpsRedirection();

            app.UseRouting();

            app.UseAuthorization(); // Auth middleware

            app.UseEndpoints(endpoints =>
            {
                endpoints.MapControllers();
            });
        }
    }
}


3. Difference

| Approach          | File Count              | Pros                                      | Cons                                |
| ----------------- | ----------------------- | ----------------------------------------- | ----------------------------------- |
| Minimal Hosting   | Program.cs only         | Simple, less boilerplate, modern          | Can get long in very large projects |
| Program + Startup | Program.cs + Startup.cs | Clear separation of services & middleware | Slightly more boilerplate           |


