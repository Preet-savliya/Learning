SQL CREATE DATABASE

The CREATE DATABASE statement is used to create a new SQL database.

CREATE DATABASE databasename;

The following SQL statement creates a database called "testDB":

CREATE DATABASE testDB;





The SQL DROP DATABASE Statement
The DROP DATABASE statement is used to drop an existing SQL database.

DROP DATABASE databasename;

DROP DATABASE Example

The following SQL statement drops the existing database "testDB":
DROP DATABASE testDB;






The SQL BACKUP DATABASE Statement
The BACKUP DATABASE statement is used in SQL Server to create a full back up of an existing SQL database.

Syntax

BACKUP DATABASE databasename
TO DISK = 'filepath';

The SQL BACKUP WITH DIFFERENTIAL Statement
A differential back up only backs up the parts of the database that have changed since the last full database backup.

Syntax

BACKUP DATABASE databasename
TO DISK = 'filepath'
WITH DIFFERENTIAL;

BACKUP DATABASE Example
The following SQL statement creates a full back up of the existing database "testDB" to the D disk:

BACKUP DATABASE testDB
TO DISK = 'D:\backups\testDB.bak';

BACKUP WITH DIFFERENTIAL Example
The following SQL statement creates a differential back up of the database "testDB":

BACKUP DATABASE testDB
TO DISK = 'D:\backups\testDB.bak'
WITH DIFFERENTIAL;









The SQL CREATE TABLE Statement
The CREATE TABLE statement is used to create a new table in a database.

Syntax
The following example creates a table called "Persons" that contains five columns: PersonID, LastName, FirstName, Address, and City:

CREATE TABLE Persons (
    PersonID int,
    LastName varchar(255),
    FirstName varchar(255),
    Address varchar(255),
    City varchar(255)
);



Create Table Using Another Table

Syntax
The following SQL creates a new table called "TestTable" (which is a copy of the "Customers" table): 

CREATE TABLE TestTable AS
SELECT customername, contactname
FROM customers;







The SQL DROP TABLE Statement
The DROP TABLE statement is used to drop an existing table in a database.

Syntax
The following SQL statement drops the existing table "Shippers":

DROP TABLE Shippers;

SQL TRUNCATE TABLE - The TRUNCATE TABLE statement is used to delete the data inside a table, but not the table itself.

Syntax
TRUNCATE TABLE table_name;









SQL ALTER TABLE Statement
The ALTER TABLE statement is used to add, delete, or modify columns in an existing table.
The ALTER TABLE statement is also used to add and drop various constraints on an existing table.

ALTER TABLE - ADD Column

Syntax

ALTER TABLE Customers
ADD Email varchar(255);

ALTER TABLE - DROP COLUMN
To delete a column in a table:

Syntax
ALTER TABLE Customers
DROP COLUMN Email;


ALTER TABLE - RENAME COLUMN
To rename a column in a table, use the following syntax:

Syntax
ALTER TABLE table_name
RENAME COLUMN old_name to new_name;

SQL Server:

EXEC sp_rename 'table_name.old_name',  'new_name', 'COLUMN';


ALTER TABLE - ALTER/MODIFY DATATYPE
To change the data type of a column in a table, use the following syntax:

SQL Server / MS Access:
ALTER TABLE table_name
ALTER COLUMN column_name datatype;

My SQL / Oracle
ALTER TABLE table_name
MODIFY COLUMN column_name datatype;






SQL Create Constraints
Constraints can be specified when the table is created with the CREATE TABLE statement, or after the table is created with the ALTER TABLE statement.

Syntax
CREATE TABLE table_name (
    column1 datatype constraint,
    column2 datatype constraint,
    column3 datatype constraint,
    ....
);

SQL Constraints
SQL constraints are used to specify rules for the data in a table.

NOT NULL - Ensures that a column cannot have a NULL value
UNIQUE - Ensures that all values in a column are different
PRIMARY KEY - A combination of a NOT NULL and UNIQUE. Uniquely identifies each row in a table
FOREIGN KEY - Prevents actions that would destroy links between tables
CHECK - Ensures that the values in a column satisfies a specific condition
DEFAULT - Sets a default value for a column if no value is specified
CREATE INDEX - Used to create and retrieve data from the database very quickly


SQL NOT NULL on CREATE TABLE
Example

CREATE TABLE Persons (
    ID int NOT NULL,
    LastName varchar(255) NOT NULL,
    FirstName varchar(255) NOT NULL,
    Age int
);

SQL NOT NULL on ALTER TABLE
To create a NOT NULL constraint on the "Age" column when the "Persons" table is already created, use the following SQL:

ALTER TABLE Persons
ALTER COLUMN Age int NOT NULL;








SQL UNIQUE Constraint
The UNIQUE constraint ensures that all values in a column are different.
Both the UNIQUE and PRIMARY KEY constraints provide a guarantee for uniqueness for a column or set of columns.
A PRIMARY KEY constraint automatically has a UNIQUE constraint.
However, you can have many UNIQUE constraints per table, but only one PRIMARY KEY constraint per table.


Example 1 
CREATE TABLE Persons (
    ID int NOT NULL UNIQUE,
    LastName varchar(255) NOT NULL,
    FirstName varchar(255),
    Age int
);

Example 2
CREATE TABLE Persons (
    ID int NOT NULL,
    LastName varchar(255) NOT NULL,
    FirstName varchar(255),
    Age int,
    UNIQUE (ID)
);

Example 3
CREATE TABLE Persons (
    ID int NOT NULL,
    LastName varchar(255) NOT NULL,
    FirstName varchar(255),
    Age int,
    CONSTRAINT UC_Person UNIQUE (ID,LastName)
);








SQL PRIMARY KEY Constraint
The PRIMARY KEY constraint is used to uniquely identify each record in a table.
Primary keys must contain unique values, and cannot contain NULL values.

Example 1
CREATE TABLE Persons (
    ID int NOT NULL,
    LastName varchar(255) NOT NULL,
    FirstName varchar(255),
    Age int,
    PRIMARY KEY (ID)
);

Example 2
CREATE TABLE Persons (
    ID int NOT NULL PRIMARY KEY,
    LastName varchar(255) NOT NULL,
    FirstName varchar(255),
    Age int
);

Example 3
CREATE TABLE Persons (
    ID int NOT NULL,
    LastName varchar(255) NOT NULL,
    FirstName varchar(255),
    Age int,
    CONSTRAINT PK_Person PRIMARY KEY (ID,LastName)
);






SQL FOREIGN KEY Constraint
The FOREIGN KEY constraint is used to prevent actions that would destroy links between tables.
A FOREIGN KEY is a field (or collection of fields) in one table, that refers to the PRIMARY KEY in another table.
The table with the foreign key is called the child table, and the table with the primary key is called the referenced or parent table.

Example 1
CREATE TABLE Orders (
    OrderID int NOT NULL,
    OrderNumber int NOT NULL,
    PersonID int,
    PRIMARY KEY (OrderID),
    FOREIGN KEY (PersonID) REFERENCES Persons(PersonID)
);

Example 2
CREATE TABLE Orders (
    OrderID int NOT NULL PRIMARY KEY,
    OrderNumber int NOT NULL,
    PersonID int FOREIGN KEY REFERENCES Persons(PersonID)
);


Example 3
CREATE TABLE Orders (
    OrderID int NOT NULL,
    OrderNumber int NOT NULL,
    PersonID int,
    PRIMARY KEY (OrderID),
    CONSTRAINT FK_PersonOrder FOREIGN KEY (PersonID)
    REFERENCES Persons(PersonID)
);








SQL CHECK Constraint
The CHECK constraint is used to limit the value range that can be placed in a column.
If you define a CHECK constraint on a column it will allow only certain values for this column.
If you define a CHECK constraint on a table it can limit the values in certain columns based on values in other columns in the row.

Example 1
CREATE TABLE Persons (
    ID int NOT NULL,
    LastName varchar(255) NOT NULL,
    FirstName varchar(255),
    Age int,
    CHECK (Age>=18)
);

Example 2
CREATE TABLE Persons (
    ID int NOT NULL,
    LastName varchar(255) NOT NULL,
    FirstName varchar(255),
    Age int CHECK (Age>=18)
);

Example 3
CREATE TABLE Persons (
    ID int NOT NULL,
    LastName varchar(255) NOT NULL,
    FirstName varchar(255),
    Age int,
    City varchar(255),
    CONSTRAINT CHK_Person CHECK (Age>=18 AND City='Sandnes')
);








SQL DEFAULT Constraints
The DEFAULT constraint is used to set a default value for a column.
The default value will be added to all new records, if no other value is specified.

Example 1
CREATE TABLE Persons (
    ID int NOT NULL,
    LastName varchar(255) NOT NULL,
    FirstName varchar(255),
    Age int,
    City varchar(255) DEFAULT 'Sandnes'
);

Example 2
CREATE TABLE Orders (
    ID int NOT NULL,
    OrderNumber int NOT NULL,
    OrderDate date DEFAULT GETDATE()
);




CREATE INDEX Syntax - Creates an index on a table. Duplicate values are allowed:

Example 

CREATE INDEX idx_lastname
ON Persons (LastName);

CREATE UNIQUE INDEX Syntax - Creates a unique index on a table. Duplicate values are not allowed:

Example

CREATE UNIQUE INDEX idx_unique_id
ON Persons (ID);


Create a multi-column (composite) index

CREATE INDEX idx_name_age
ON Persons (LastName, Age);

Index helps queries that filter by LastName and Age together
Order of columns matters

Drop an Index - The DROP INDEX statement is used to delete an index in a table.

DROP INDEX idx_lastname;











SQL AUTO INCREMENT Field

AUTO INCREMENT Field
Auto-increment allows a unique number to be generated automatically when a new record is inserted into a table.
Often this is the primary key field that we would like to be created automatically every time a new record is inserted.

Example

CREATE TABLE Persons (
    Personid int NOT NULL AUTO_INCREMENT,
    LastName varchar(255) NOT NULL,
    FirstName varchar(255),
    Age int,
    PRIMARY KEY (Personid)
);

example 2

CREATE TABLE Persons (
    Personid int IDENTITY(1,1) PRIMARY KEY,
    LastName varchar(255) NOT NULL,
    FirstName varchar(255),
    Age int
);











SQL Date Data Types
DATE - format YYYY-MM-DD
DATETIME - format: YYYY-MM-DD HH:MI:SS
SMALLDATETIME - format: YYYY-MM-DD HH:MI:SS
TIMESTAMP - format: a unique number






SQL CREATE VIEW Statement
Example 1

CREATE VIEW [Brazil Customers] AS
SELECT CustomerName, ContactName
FROM Customers
WHERE Country = 'Brazil';


SQL Updating a View
A view can be updated with the CREATE OR REPLACE VIEW statement.

Example 
CREATE OR REPLACE VIEW [Brazil Customers] AS
SELECT CustomerName, ContactName, City
FROM Customers
WHERE Country = 'Brazil';










SQL Injection - SQL injection is a code injection technique that might destroy your database.
SQL injection is one of the most common web hacking techniques.
SQL injection is the placement of malicious code in SQL statements, via web page input.

Example
user_input = "1 OR 1=1"
query = "SELECT * FROM Persons WHERE ID = " + user_input

This would turn the query into:
SELECT * FROM Persons WHERE ID = 1 OR 1=1;

How to prevent SQL injection - The safe way is to use parameterized queries / prepared statements

-- Unsafe:
SELECT * FROM Persons WHERE ID = user_input;

-- Safe (pseudo code):
SELECT * FROM Persons WHERE ID = ?;

? is a placeholder
The database treats the input as data, not code
This completely prevents injection



